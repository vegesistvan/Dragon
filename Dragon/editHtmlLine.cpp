// GaLine.cpp : implementation file
//

#include "stdafx.h"
#include "dragon.h"
#include "editHtmlLine.h"
#include "afxdialogex.h"


// CEditHtmlLine dialog
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
IMPLEMENT_DYNAMIC(CEditHtmlLine, CDialogEx)
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CEditHtmlLine::CEditHtmlLine(CWnd* pParent /*=NULL*/)
	: CDialogEx(CEditHtmlLine::IDD, pParent)
{

}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CEditHtmlLine::~CEditHtmlLine()
{
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEditHtmlLine::DoDataExchange(CDataExchange* pDX)
{
	CDialogEx::DoDataExchange(pDX);
	DDX_Control(pDX, IDC_EDIT, m_EditCtrl);
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

BEGIN_MESSAGE_MAP(CEditHtmlLine, CDialogEx)
	ON_EN_CHANGE(IDC_EDIT, &CEditHtmlLine::OnChangeEdit)
	ON_BN_CLICKED(IDOK, &CEditHtmlLine::OnClickedMent)
END_MESSAGE_MAP()
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
BOOL CEditHtmlLine::OnInitDialog()
{
	CDialogEx::OnInitDialog();


//	m_caption.Format( L"A %s fájl %s. sora", theApp.m_htmlPathName, m_linenumber );
	
	SetWindowTextW( m_title );

	GetDlgItem( IDOK )->EnableWindow( FALSE );

	m_line = theApp.getHtmlLine( m_linenumber );
	m_line = m_line.Mid( 2 );

	GetDlgItem( IDC_EDIT )->SetWindowTextW( m_line );
	return TRUE;
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEditHtmlLine::OnClickedMent()
{
	GetDlgItem( IDC_EDIT )->GetWindowTextW( m_line );
//	if( AfxMessageBox( L"Felülírod a ga.html fájl sorát ezzel a módosított sorral?", MB_YESNO ) == IDNO ) return;

	theApp.saveHtmlLine( _wtoi( m_linenumber ), m_line );
	CDialog::OnOK();
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CEditHtmlLine::OnChangeEdit()
{
	GetDlgItem( IDOK )->EnableWindow( TRUE );

}

